<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <title>Remito - Nota de <?php echo $firstPage['generalInformation']['noteType'] ?></title>
    <style type="text/css">

        @page {
            margin: 2cm;
        }

        body {
            font-family: sans-serif;
            margin: 150px 0 0 0;
            text-align: justify;
            counter-reset: page;
        }

        #header {
            display: block;
            position: fixed;
            left: 0;
            right: 0;
            color: #aaa;
            font-size: 0.9em;
        }

        #header {
            top: 0;
        }

        #header table {
            width: 100%;
            border-collapse: collapse;
            border: none;
        }

        #header td {
            padding: 0;
            width: 50%;
        }

        .page-number {
            text-align: center;
        }

        .page-number:before {
            content: "HOJA: " counter(page);
        }

        .reset-page {
            counter-reset: page;
        }

        hr.jump-page {
            page-break-after: always;
            border: 0;
        }

        .receipt-body {
            color: #aaa;
            font-size: 0.9em;
            display: block;
        }

        .receipt-body table {
            border-collapse: collapse;
            border: none;
        }

        .receipt-body td {
            padding: 0;
        }

        .right {
            text-align: right;
        }

        .nowrap {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

    </style>
</head>
<body>
<div style="position: relative;">
    <div style="position: relative">
        <p style="width: 100%; position: absolute; left: 200px; font-size: 12px; margin: 0; text-align: right; right: 100px;">
            NOTA DE <?php echo strtoupper($firstPage['generalInformation']['noteType']) ?> -
            REMITO <?php echo $firstPage['generalInformation']['receipt_number'] ?></p>
        <p style="width: 100%; position: absolute; top: 17px; left: 450px; font-size: 12px; margin: 0; text-align: right; right: 100px"><?php echo date_format(date_create_from_format('Y-m-d', $firstPage['generalInformation']['date_created'] ), 'd/m/Y') ?></p>
        <p style="position: absolute; top: 90px; left: 69px; font-size: 12px; margin: 0;"><?php echo $firstPage['header']['settlement_name'] ?></p>
        <p style="position: absolute; top: 100px; left: 69px; font-size: 12px; margin: 0;"><?php echo $firstPage['header']['iva_description'] ?></p>
        <p style="width: 100%; position: absolute; top: 90px; left: 450px; font-size: 12px; margin: 0; text-align: right; right: 100px"><?php echo $firstPage['header']['address'] ?></p>
        <p style="width: 100%; position: absolute; top: 100px; left: 450px; font-size: 12px; margin: 0; text-align: right; right: 100px"><?php echo $firstPage['header']['cuit'] ?></p>
    </div>
    <div style="position: relative; top: 252px; left: 12px; font-size: 12px; margin: 12px; width: 100%;">
        <div style="position: relative; width: 100%">
            <p style="margin: 5px; left:12px;">APLICA A
                DOCUMENTO <?php echo $firstPage['generalInformation']['type_document'] ?> <?php echo $firstPage['generalInformation']['type_form'] ?>
                -<?php echo $firstPage['generalInformation']['branch_office'] ?>
                -<?php echo $firstPage['generalInformation']['number_bill']  ?></p>
        </div>
        <div style="position: relative; width: 100%; margin-top: 20px;">
            <p style="margin: 5px; left:12px;">HONORARIOS........</p>
            <p style="position: absolute; right: 100px; display: block; top: 0;"><?php echo number_format($endData['honoraryTotalReceipt'], 2) ?></p>
        </div>
        <div style="width: 100%; position: relative">
            <p style="margin: 5px; left:12px;">GASTOS............</p>
            <p style="position: absolute; right: 100px; display: block; top: 0;"><?php echo number_format($endData['expensesTotalReceipt'], 2) ?></p>
        </div>
        <div style="width: 100%; position: relative">
            <p style="margin: 5px 0 0 80px">SUBTOTAL.....</p>
            <p style="position: absolute; right: 100px; display: block; top: 0;"><?php echo number_format($endData['generalTotalReceipt'], 2) ?></p>
        </div>
        <div style="width: 100%; position: relative">
            <p style="margin: 5px 5px 5px 80px">****TOTAL GENERAL</p>
            <p style="position: absolute; right: 100px; display: block; top: 0;"><?php echo number_format($endData['generalTotalReceipt'], 2) ?></p>
        </div>
        <div style="width: 100%; text-align: justify; ">
            <p style="margin: 5px">SON PESOS: <?php echo $firstPage['generalInformation']['letter_total'] ?></p>
        </div>
    </div>
</div>
<hr class="jump-page reset-page">
<div id="header">
    <table style="width: 100%">
        <tbody>
        <tr></tr>
        <tr>
            <td colspan="6" style="padding-top: 20px">CIRCULO MEDICO DE ZARATE</td>
        </tr>
        <tr>
            <td colspan="3">ITUZAINGO 543/45</td>
            <td colspan="3" style="text-align: right;">
                NOTA DE <?php echo strtoupper($firstPage['generalInformation']['noteType']) ?> -
                REMITO:&#09;<?php echo $firstPage['generalInformation']['receipt_number'] ?></td>
        </tr>
        <tr>
            <td colspan="3">CUIT : 33-56306138-9</td>
            <td colspan="3" style="text-align: right;" class="page-number"></td>
        </tr>
        <tr>
            <td colspan="6">I.B. : 33-BYZ-56306138-2</td>
        </tr>
        <tr>
            <td colspan="6">I.V.A EXENTO</td>
        </tr>
        <tr>
            <td><br></td>
        </tr>
        <tr>
            <td colspan="2" class="nowrap"><?php echo $firstPage['header']['settlement_name'] ?>
                <?php if(!empty($firstPage['generalInformation']['plan_description'])) echo $firstPage['generalInformation']['plan_description'] ?>
            </td>
            <td colspan="2" style="text-align: center"><?php echo $firstPage['header']['address'] ?></td>
            <td colspan="2" style="text-align: center; text-overflow: ellipsis">BUENOS AIRES</td>
        </tr>
        <tr>
            <td colspan="2">C.U.I.T : <?php echo $firstPage['header']['cuit'] ?></td>
            <td colspan="4" style="text-align: center">I.V.A
                : <?php echo $firstPage['header']['iva_description'] ?></td>
        </tr>
        <tr>
            <td colspan="6">
                <hr>
            </td>
        </tr>
        <tr>
            <td>MATRICULA</td>
            <td colspan="3">APELLIDO Y NOMBRE</td>
            <td>C.U.I.T</td>
            <td>ING.BRUTOS</td>
        </tr>
        <tr>
            <td style="width: 10%">CANTI</td>
            <td>C.NOMEN</td>
            <td class="right">VISITAS</td>
            <td class="right">HONOR</td>
            <td class="right">GASTOS</td>
            <td class="right">IMPORTE</td>
        </tr>
        <tr>
            <td colspan="6">
                <hr>
            </td>
        </tr>
    </table>
</div>
<div class="receipt-body">
    <?php $periodCount = count($body) ?>
    <?php foreach($body as $key=>$period): ?>
    <table style="width:100%;">
        <tbody>
        <tr>
            <td colspan="5">***PRESTACIONES CORRESPONDIENTES AL PERIODO:
                <?php echo date_format(date_create_from_format('Y-m-d', array_values(array_values($period)[0])[0]['period']), 'm/Y') ?>
                ***
            </td>
        </tr>
        <?php $count = count($period) ?>
        <?php foreach($period as $key=>$prof) :?>
        <?php if (--$count <= 0) { ?>
        <tr>
            <td><?php echo $prof['period_benefit_quantity'] ?></td>
            <td class="nowrap">TOTAL
                PERIODO: <?php echo date_format(date_create_from_format('Y-m-d', array_values(array_values($period)[0])[0]['period']), 'm/Y') ?></td>
            <td class="right"><?php echo number_format($prof['period_visit_total'], 2) ?></td>
            <td class="right"><?php echo number_format($prof['period_honorary_total'], 2) ?></td>
            <td class="right"><?php echo number_format($prof['period_expenses_total'], 2) ?></td>
            <td class="right"><?php echo number_format($prof['period_total'], 2) ?></td>
        </tr>
        <?php break; } ?>
        <tr>
            <td><?php echo array_values($prof)[0]['registration_number'] ?></td>
            <td colspan="3"><?php echo array_values($prof)[0]['name'] ?></td>
            <td class="nowrap" style="text-align: right"><?php echo array_values($prof)[0]['cuit'] ?></td>
            <td class="nowrap" style="text-align: right"><?php echo array_values($prof)[0]['iibb'] ?></td>
        </tr>
        <?php foreach($prof as $key=>$benefit) :?>
        <tr>
            <td><?php echo $benefit['quantity'] ?></td>
            <td><?php echo $benefit['code'] ?></td>
            <td class="right"><?php echo number_format($benefit['value_visit'], 2) ?></td>
            <td class="right"><?php echo number_format($benefit['value_honorary'], 2) ?></td>
            <td class="right"><?php echo number_format($benefit['value_expenses'], 2) ?></td>
            <td class="right"><?php echo number_format($benefit['benefit_total'], 2) ?></td>
        </tr>
        <?php endforeach; ?>
        <tr>
            <td><?php echo array_values($prof)[0]['professional_quantity_total'] ?></td>
            <td>TOTAL <?php echo array_values($prof)[0]['registration_number'] ?></td>
            <td class="right"><?php echo number_format(array_values($prof)[0]['professional_visit_total'], 2) ?></td>
            <td class="right"><?php echo number_format(array_values($prof)[0]['professional_honorary_total'], 2) ?></td>
            <td class="right"><?php echo number_format(array_values($prof)[0]['professional_expenses_total'], 2) ?></td>
            <td class="right"><?php echo number_format(array_values($prof)[0]['professional_total'], 2) ?></td>
        </tr>
        <tr>
            <td colspan="6">
                <hr>
            </td>
        </tr>
        <?php endforeach; ?>
        <?php if (--$periodCount <= 0) { ?>
        <tr>
            <td colspan="6" style="height: 20px"></td>
        </tr>
        <tr>
            <td><?php echo $endData['quantityTotalReceipt'] ?></td>
            <td>TOTAL:</td>
            <td class="right"><?php echo number_format($endData['visitTotalReceipt'], 2) ?></td>
            <td class="right"><?php echo number_format($endData['honoraryTotalReceipt'], 2) ?></td>
            <td class="right"><?php echo number_format($endData['expensesTotalReceipt'], 2) ?></td>
            <td class="right"><?php echo number_format($endData['generalTotalReceipt'], 2) ?></td>
        </tr>
        <?php } ?>
        </tbody>
    </table>
    <?php if ($periodCount > 0) { ?>
    <hr class="jump-page">
    <?php } ?>
    <?php endforeach; ?>
    <table style="width: 50%; margin-top: 20px">
        <tbody>
        <tr>
            <td>***TOTAL GENERAL</td>
            <td class="right"><?php echo number_format($endData['generalTotalReceipt'], 2) ?></td>
        </tr>
        <tr>
            <td>CANTIDAD DE:</td>
        </tr>
        <tr>
            <td>VISITAS</td>
            <td class="right"><?php echo $endData['visitQuantity'] ?></td>
        </tr>
        <tr>
            <td>CIRUGIAS</td>
            <td class="right"><?php echo $endData['surgeryQuantity'] ?></td>
        </tr>
        <tr>
            <td>PRACTICAS</td>
            <td class="right"><?php echo $endData['practiceQuantity'] ?></td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>